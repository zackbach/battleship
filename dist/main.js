(()=>{"use strict";const t=t=>{let e,i;t?(e=document.getElementById("playerBoard"),i="player"):(e=document.getElementById("compBoard"),i="comp");for(let t=0;t<10;t++)for(let o=0;o<10;o++){const s=document.createElement("div");s.classList.add("square"),s.id=`${i}${o}${t}`,e.appendChild(s)}},e=t=>{Array.prototype.slice.call(document.getElementById("playerBoard").childNodes).forEach((t=>{t.classList.remove("len2"),t.classList.remove("len3"),t.classList.remove("len4"),t.classList.remove("len5")})),t.ships.forEach((e=>{e.occupied.forEach((i=>{let o=i[0],s=i[1];document.getElementById(`player${o}${s}`).classList.add(`len${e.length}`),document.getElementById(`player${o}${s}`).onclick=()=>{t.select(t.ships.indexOf(e))}}))}))},i=(t,e)=>{let i;i=t.isHuman?"player":"comp",e.hit.forEach((t=>{let e=t[0],o=t[1];document.getElementById(`${i}${e}${o}`).classList.add("hit")})),e.missed.forEach((t=>{let e=t[0],o=t[1];document.getElementById(`${i}${e}${o}`).classList.add("missed")}))},o=(t,e,i,o)=>{let s=[e,i],a=o,l=t,n=new Array(t);for(let e=0;e<t;e++)n[e]=0;let c=new Array(t);const h=(e,i)=>{if(a)for(let o=0;o<t;o++)c[o]=[e,i+o];else for(let o=0;o<t;o++)c[o]=[e+o,i]};return h(s[0],s[1]),{location:s,health:n,occupied:c,hit:(e,i)=>{for(let o=0;o<t;o++)if(c[o][0]===e&&c[o][1]===i)return n[e+i-s[0]-s[1]]=1,!0;return!1},checkSunk:()=>{for(let e=0;e<t;e++)if(0===n[e])return!1;return!0},updateLocation:function(t,e){this.location=[t,e],h(t,e)},rotate:function(){this.isRotated=!this.isRotated},length:l,isRotated:a}},s=()=>{let t=[];const e=()=>{let e=[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]];return t.forEach((t=>{t.occupied.forEach((i=>{e[i[1]][i[0]]=t.length}))})),e};return{ships:t,placeShip:function(t,i,s,a){if(!1===a){if(i>-1&&s>-1&&i+t-1<10&&s<10){for(let e=0;e<t;e++)if(0!==this.board[s][i+e])return!1;return this.ships.push(o(t,i,s,!1)),this.board=e(),!0}return!1}if(!0===a){if(i>-1&&s>-1&&i<10&&s+t-1<10){for(let e=0;e<t;e++)if(0!==this.board[s+e][i])return!1;return this.ships.push(o(t,i,s,!0)),this.board=e(),!0}return!1}alert("ERROR: ROTATED IS NEITHER TRUE NOR FALSE")},attack:function(t,i){let o=!1;if(this.hit.forEach((e=>{e[0]===t&&e[1]===i&&(o=!0)})),this.missed.forEach((e=>{e[0]===t&&e[1]===i&&(o=!0)})),!1===o){if(0===this.board[i][t])return this.missed.push([t,i]),!0;this.hit.push([t,i]);for(let o=0;o<this.ships.length;o++)this.ships[o].hit(t,i)&&this.ships[o].checkSunk()&&(this.ships.splice(o,1),this.board=e());return!0}return!1},hit:[],missed:[],board:[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]],moveShip:function(t){let i=this.ships.length-1,o=this.ships[i];switch(t){case 0:this.ships.splice(i,1),this.board=e(),this.placeShip(o.length,o.location[0],o.location[1]-1,o.isRotated)||this.placeShip(o.length,o.location[0],o.location[1],o.isRotated);break;case 1:this.ships.splice(i,1),this.board=e(),this.placeShip(o.length,o.location[0]+1,o.location[1],o.isRotated)||this.placeShip(o.length,o.location[0],o.location[1],o.isRotated);break;case 2:this.ships.splice(i,1),this.board=e(),this.placeShip(o.length,o.location[0],o.location[1]+1,o.isRotated)||this.placeShip(o.length,o.location[0],o.location[1],o.isRotated);break;case 3:this.ships.splice(i,1),this.board=e(),this.placeShip(o.length,o.location[0]-1,o.location[1],o.isRotated)||this.placeShip(o.length,o.location[0],o.location[1],o.isRotated);break;case 4:this.ships.splice(i,1),this.board=e(),this.placeShip(o.length,o.location[0],o.location[1],!o.isRotated)||this.placeShip(o.length,o.location[0],o.location[1],o.isRotated);break;default:alert("ERROR: DIRECTION IS INVALID")}},select:function(t){this.ships.push(this.ships.splice(t,1)[0])}}},a=s(),l=s(),n={placeShips:t=>{[2,3,3,4,5].forEach((e=>{let i=!1;for(;!1===i;){let o=Math.random()<.5;t.placeShip(e,Math.floor(10*Math.random()),Math.floor(10*Math.random()),o)&&(i=!0)}}))},makeAttack:t=>{let e=!1;for(;!1===e;)t.attack(Math.floor(10*Math.random()),Math.floor(10*Math.random()))&&(e=!0)},isHuman:!1},c={isHuman:!0,makeAttack:(t,e,i)=>{let o=!1;for(;!1===o;)t.attack(e,i)?o=!0:alert("Please make a valid move")},myTurn:!0,swapTurns:function(){this.myTurn=!this.myTurn}};n.placeShips(a),n.placeShips(l),t(!0),t(!1),e(a),document.getElementById("up").onclick=()=>{a.moveShip(0),e(a)},document.getElementById("right").onclick=()=>{a.moveShip(1),e(a)},document.getElementById("down").onclick=()=>{a.moveShip(2),e(a)},document.getElementById("left").onclick=()=>{a.moveShip(3),e(a)},document.getElementById("rotate").onclick=()=>{a.moveShip(4),e(a)},document.getElementById("start").onclick=()=>{document.getElementById("mvmt").classList.add("gone"),document.getElementById("tip").textContent="It is the player's turn.",((t,e,o,s,a)=>{for(let l=0;l<10;l++)for(let n=0;n<10;n++)document.getElementById(`comp${n}${l}`).onclick=()=>{!1===a&&(s.attack(n,l)?(i(o,s),0===s.ships.length&&(a=!0,document.getElementById("winner").textContent="Player Wins!!"),o.makeAttack(e),i(t,e),0===e.ships.length&&(a=!0,document.getElementById("winner").textContent="Computer Wins!!")):alert("Please make a valid move"))}})(c,a,n,l,!1)}})();